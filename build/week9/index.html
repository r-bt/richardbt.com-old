<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="/classes/MAS.863/EECS/people/Richard/favicon.png" />
		<script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
		<meta name="viewport" content="width=device-width" />
		<meta http-equiv="content-security-policy" content="">
		<link href="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/week_layout-29436407.css" rel="stylesheet">
		<link href="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/Avatar-948cd85c.css" rel="stylesheet">
		<link href="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/Image-307b1d0c.css" rel="stylesheet">
		<link href="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/Info-cd969386.css" rel="stylesheet">
		<link href="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/SideBySide-eb2b74fa.css" rel="stylesheet">
		<link rel="modulepreload" href="/classes/MAS.863/EECS/people/Richard/_app/immutable/start-a59e6437.js">
		<link rel="modulepreload" href="/classes/MAS.863/EECS/people/Richard/_app/immutable/chunks/index-3de37d12.js">
		<link rel="modulepreload" href="/classes/MAS.863/EECS/people/Richard/_app/immutable/chunks/singletons-cc557a36.js">
		<link rel="modulepreload" href="/classes/MAS.863/EECS/people/Richard/_app/immutable/chunks/paths-6cd3a76e.js">
		<link rel="modulepreload" href="/classes/MAS.863/EECS/people/Richard/_app/immutable/components/layout.svelte-c5fba7fe.js">
		<link rel="modulepreload" href="/classes/MAS.863/EECS/people/Richard/_app/immutable/modules/pages/_layout.js-7b9cbfbc.js">
		<link rel="modulepreload" href="/classes/MAS.863/EECS/people/Richard/_app/immutable/chunks/_layout-8d2a742b.js">
		<link rel="modulepreload" href="/classes/MAS.863/EECS/people/Richard/_app/immutable/components/pages/week9/_page.svx-aa9bb9c4.js">
		<link rel="modulepreload" href="/classes/MAS.863/EECS/people/Richard/_app/immutable/chunks/week_layout-f7784e77.js">
		<link rel="modulepreload" href="/classes/MAS.863/EECS/people/Richard/_app/immutable/chunks/Avatar-da2dfb39.js">
		<link rel="modulepreload" href="/classes/MAS.863/EECS/people/Richard/_app/immutable/chunks/Image-90aace8f.js">
		<link rel="modulepreload" href="/classes/MAS.863/EECS/people/Richard/_app/immutable/chunks/Info-27e8a139.js">
		<link rel="modulepreload" href="/classes/MAS.863/EECS/people/Richard/_app/immutable/chunks/SideBySide-02aeca15.js">
	</head>
	<body>
		<div>


<div class="avatar svelte-ketdv1"><a href="/classes/MAS.863/EECS/people/Richard" id="home-link"><h3 class="svelte-ketdv1">Richard Beattie</h3></a>
</div>

<div class="content svelte-b15ume"><h1>09 | Input devices</h1>
    <div class="text-body svelte-b15ume"><p>This week was all about input devices. I’d had some experience with breakout boards for Arduino which let you measure temperature (with thermistors) or acceleration and tilt (with an MPU) but during lecture we learned about how to build our own versions of these sensors.</p>
<h2>Capacitive touchpad</h2>
<p>To start I wanted to make a capacitive touchpad. This had been done a ton by other HTMAA students so there were example boards and demonstrations of how this would work:</p>
<ul><li><a href="http://fab.cba.mit.edu/classes/863.10/people/matt.blackshaw/week8.html" rel="nofollow">Touchpad by Matt Blackshaw</a></li>
<li><a href="http://fab.cba.mit.edu/classes/863.11/people/matthew.keeter/multitouch/index.html" rel="nofollow">Multitouchpad by Matt Keeter</a></li>
<li><a href="http://fabacademy.org/2021/labs/waag/students/nadieh-bremer/blog/week-11/" rel="nofollow">Nadieh Bremer</a></li>
<li><a href="https://roberthart56.github.io/SCFAB/SC_lab/Sensors/tx_rx_sensors/index.html" rel="nofollow">Robert Hart</a></li></ul>
<p>Unfortunally, while the two Matts implemenations of capacitive touch sensing is super cool they are sparse on details. I didn’t give myself nearly enough time for this so I started looking into the physics behind these circuits on Monday and got lost pretty quickly.</p>
<p>I then decided that I would just design the board and come back to try understand it later. I wanted mine to roughly match the grid Matt Blackshaw had made but I wanted my sensor on the pcb board rarther than with vinyl. </p>
<h3>Custom SMD part</h3>
<p>In Eagle, I started a new file and quickly realised that I had no clue how to make my own custom pads. After a brief goolge, it didn’t seem like there was a fast way to do this instead everyone recommended that I make my own library. Thankfully
<a href="https://learn.adafruit.com/ktowns-ultimate-creating-parts-in-eagle-tutorial/introduction" rel="nofollow">Adafruit</a> has a nice guide for how to do this.</p>
<p>First I created a new library by going to <strong>File &gt; New Electronics Library</strong>. </p>
<div><figure style="--image-width: 400px" class="svelte-1pffeem"><img src="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/newElectronics-2ea9632d.jpeg" alt="Creating a Eagle Library" class="svelte-1pffeem">
        <figcaption align="center" class="svelte-1pffeem">
            <b>Creating a Eagle Library</b></figcaption></figure>
</div>
<p>Then I needed to create a new package. This is where our new footprint and schmematic will live.</p>
<p>I didn’t need any specical 3D model for my capacitive touch pad so I went immediately to create footprint. Here I created an SMD pad (<strong>Place &gt; SMD Pad</strong>) and changed it size in the side editor which apperared to 100mil x 100mil which is 1cmx1cm. I also wanted a nice aesthetic so I rotate the pad by 45 degress.</p>
<div><figure style="--image-width: 400px" class="svelte-1pffeem"><img src="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/pad-ab018288.jpeg" alt="Creating a pad" class="svelte-1pffeem">
        <figcaption align="center" class="svelte-1pffeem">
            <b>Creating a pad</b></figcaption></figure>
</div>
<p>With the SMD pad made I now needed to make it’s symbol. I switched to create symbol (<strong>Create new symbol</strong>) and used the wire tool to create a box. I also needed a pin (<strong>Place &gt; Pin</strong>) where I would route my wires to.</p>
<div><figure style="--image-width: 400px" class="svelte-1pffeem"><img src="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/symbol-319068d0.jpeg" alt="Creating a symbol" class="svelte-1pffeem">
        <figcaption align="center" class="svelte-1pffeem">
            <b>Creating a symbol</b></figcaption></figure>
</div>
<p>Finally the last thing I needed to do was connect my footprint and symbol. This is done in a device file (<strong>Create new device</strong>). Here I added my schematic and footprint and then associated them together by clicking on <strong>Connect</strong> and then selcting my pin and pad. After that I was done, I added the my new library to Eagle and began making my touchpad.</p>
<div><figure style="--image-width: 400px" class="svelte-1pffeem"><img src="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/connectingPadSymbol-453106e1.jpeg" alt="Conecting to pad to symbol" class="svelte-1pffeem">
        <figcaption align="center" class="svelte-1pffeem">
            <b>Conecting to pad to symbol</b></figcaption></figure>
</div>
<h3>Designing the touchpad</h3>
<p>The schematic is super simple but I did get to use Eagle’s new pattern tool which made copying and positioning the pads in the schematic super easy.</p>
<p>Unfortunally, eagle doens’t support patterning while routing which meant that I had to individual move and align each pad and for the rows a 0ohm resistor to jump over the traces for the column.</p>
<h3>Understanding how the board works</h3>
<p>At this point I had my board complete but I still didn’t fully understand how it worked. I’m pretty sure I need to add resistors somewhere between the input and output bins on the board I’d use with this grid but this week is super busy with 3-day notice psets and a midterm so I knew I didn’t have time to explore this further.</p>
<p>Apparantly lots of people wanted to work with capacitive touch however so a HTMAA TA put out a small <a href="https://gitlab.cba.mit.edu/classes/863.22/site/-/tree/master/doc/input_devices/capacitive_sensing" rel="nofollow">guide</a>.</p>
<div class="svelte-163csyz">I decided I&#39;d pause the capacitive touch grid and come back to it on a week where I have more time

</div>
<h2>hall Effect sensor</h2>
<h3>Designing the board</h3>
<p>Instead, I switched to designing a hall effect sensor board. I thought Neil’s demonstration of positioning objects in 3D was super impressive with these and depending on how I implement my inkjet 3D printer I may need to build endstops / know the position of the inkjet printer head and hence could use this sensor.</p>
<p>As I was in a little bit of rush (it was Tuesday by now) I decided to keep things simple and followed the example hall effect with the D11C board. Using a Attiny is something I should do in the future, but I didn’t want to have to mess with setting up how it’s code is flashed. </p>
<p>Using my previous eagle files and the diagram Neil provided I quickly create the schematic and routed the board. In Neil’s version he has a trace which runs under the 3.3v regulator, however this was too small for the Othermill so I switched to a 0ohm resistor.</p>
<div class="svelte-zt0wpp"><div><figure style="--image-width: 400px" class="svelte-1pffeem"><img src="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/schematicForBoard-cd2d30d9.jpeg" alt="Board schematic" class="svelte-1pffeem">
        <figcaption align="center" class="svelte-1pffeem">
            <b>Board schematic</b></figcaption></figure>
</div>
    <div><figure style="--image-width: 400px" class="svelte-1pffeem"><img src="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/routedBoard-eef1c30d.jpeg" alt="Routed board" class="svelte-1pffeem">
        <figcaption align="center" class="svelte-1pffeem">
            <b>Routed board</b></figcaption></figure>
</div>
</div>
<div class="svelte-j9qyje">The fab eagle library doesn&#39;t include a footprint for a hall-effect sensor so I had to find <a href="https://www.snapeda.com/parts/A1324LLHLT-T/ALLEGRO%20MICROSYSTEMS%20(VA)/view-part/?ref=digikey">one online</a>
    
</div>
<h3>Milling the board</h3>
<p>Milling the board took a while as I unfortunally broke a couple of endmills, for entirely stupid reasons too. I forgot to close on the boxes and then while trying to take on and off the different screens hit it with my hand and broke the two endmills inside. </p>
<p>Then I had issues with positioning my board correcly, someone had left on the pcb bracket but I didn’t realise that I needed to probe this to get the positioning correct. At one point the Othermill moved over the bracket and started coming down. Thankfully I was looking at the machine when it did this and stopped it quickly but not before it hit the bracket and destroyed the endmill.</p>
<p>After about an hour though I fixed everything and milled my board.</p>
<h3>Stuffing my board</h3>
<p>Stuffing was a breeze and it’s cool to see how much faster I can do it now than during the second week. EDS did not have the exact hall-effect sensor which I used in my schematic (A1324 four) but the one they did have was roughly the same size and after checking it’s schematic had the same pin posititons</p>
<div class="svelte-zt0wpp"><div><figure style="--image-width: 400px" class="svelte-1pffeem"><img src="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/hallEffect-74163d3e.jpeg" alt="Hall Effect sensor" class="svelte-1pffeem">
        <figcaption align="center" class="svelte-1pffeem">
            <b>Hall Effect sensor</b></figcaption></figure>
</div>
    <div><figure style="--image-width: 400px" class="svelte-1pffeem"><img src="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/solderedBoard-dcc9b041.jpeg" alt="Soldered board" class="svelte-1pffeem">
        <figcaption align="center" class="svelte-1pffeem">
            <b>Soldered board</b></figcaption></figure>
</div>
</div>
<h3>Flashing the bootloader board</h3>
<p>I decided to use the 2x2 pin connectors to conserve space but this meant I couldn’t use the ribbon cable I had been with the Atmel-Ice. Thanfully, Anthony had broken out the Atmel’s cable into indivdual strands to handle any connectors.</p>
<div><figure style="--image-width: 400px" class="svelte-1pffeem"><img src="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/messOfCables-512e88bd.jpeg" alt="Mess of cables" class="svelte-1pffeem">
        <figcaption align="center" class="svelte-1pffeem">
            <b>Mess of cables</b></figcaption></figure>
</div>
<p>I looked up the SWD pinouts and matched the numbers from the graph with the numbers on the cables and the pin they needed to go in</p>
<div class="svelte-zt0wpp"><div><figure style="--image-width: 400px" class="svelte-1pffeem"><img src="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/swdPinout-36a05f5c.jpeg" alt="SWD Pinout" class="svelte-1pffeem">
        <figcaption align="center" class="svelte-1pffeem">
            <b>SWD Pinout</b></figcaption></figure>
</div>
    <div><figure style="--image-width: 400px" class="svelte-1pffeem"><img src="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/flashing-4737a78b.jpeg" alt="Flashing bootloader" class="svelte-1pffeem">
        <figcaption align="center" class="svelte-1pffeem">
            <b>Flashing bootloader</b></figcaption></figure>
</div>
</div>
<p>This didn’t work the first time since the Atmel requires that it’s VCC pin be provided with 3.3v and the 2x2 doesn’t have a pin for this so I had to put a jumper wire into the 3.3 wire and connect it by hand</p>
<div><figure style="--image-width: 400px" class="svelte-1pffeem"><img src="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/connectingAtmelToVCC-964721b7.jpeg" alt="Connecting Atmel to VCC" class="svelte-1pffeem">
        <figcaption align="center" class="svelte-1pffeem">
            <b>Connecting Atmel to VCC</b></figcaption></figure>
</div>
<h3>Programming the board</h3>
<p>I copied Neil’s <strong>hello.mag.USB.ino</strong> code into the Arduino IDE and uploaded this to my board </p>
<div><figure style="--image-width: 400px" class="svelte-1pffeem"><img src="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/uploadingCode-384c1b6c.jpeg" alt="Uploading my code" class="svelte-1pffeem">
        <figcaption align="center" class="svelte-1pffeem">
            <b>Uploading my code</b></figcaption></figure>
</div>
<p>To see the visualization I downloade the webpage and javascript server Neil created. These must of been made a while ago as when I tried to run it with node I got tons of errors, once I uploaded all the libraries everything connected and when I brought a magnet close the values changed!</p>
<div><figure style="--image-width: 400px" class="svelte-1pffeem"><img src="/classes/MAS.863/EECS/people/Richard/_app/immutable/assets/webserver-df35ddb7.jpeg" alt="Webserver" class="svelte-1pffeem">
        <figcaption align="center" class="svelte-1pffeem">
            <b>Webserver</b></figcaption></figure>
</div></div>
</div>


		<script type="module" data-sveltekit-hydrate="1o5w0ab">
			import { start } from "/classes/MAS.863/EECS/people/Richard/_app/immutable/start-a59e6437.js";

			start({
				env: {},
				hydrate: {
					status: 200,
					error: null,
					node_ids: [0, 16],
					params: {},
					routeId: "week9",
					data: (function(a){return [a,a]}(null)),
					form: null
				},
				paths: {"base":"/classes/MAS.863/EECS/people/Richard","assets":"/classes/MAS.863/EECS/people/Richard"},
				target: document.querySelector('[data-sveltekit-hydrate="1o5w0ab"]').parentNode,
				trailing_slash: "always"
			});
		</script>
	</div>
	</body>
	<style>
		html, body {
			margin: 0;
			font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
		}
	</style>
</html>
